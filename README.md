# MNIST 手写数字识别项目说明

## 项目简介

本项目基于卷积神经网络（CNN）实现 MNIST 手写数字数据集的识别，包含模型训练、单样本测试及 Web 交互演示三个核心功能，旨在展示深度学习在图像识别领域的应用流程。

## 1. 项目运行结果呈现

### 1.1 模型性能

- 训练完成后，模型在测试集上的准确率可达 98.5% 以上（具体结果取决于训练参数）
- 示例输出：`测试集准确率: 0.9876`

### 1.2 测试脚本（test.py）结果

- 可指定测试集中的任意样本进行预测，输出预测概率分布及最终分类结果

- 自动保存预测样本的图像（如`第5张.png`），示例输出：

  ```plaintext
  [1.2e-06 3.5e-05 ... 9.98e-01 2.1e-04] 转换一下格式得到：7
  ```

### 1.3 Web 应用（app.py）结果

- 支持两种预测模式：
  - 测试集模式：选择测试集中的样本进行预测
  - 手绘模式：在线绘制数字并实时预测
- 输出内容：预测结果、置信度分布、处理后的图像

## 2. 模型训练日志展示

训练过程日志示例（train.py 执行输出）：

```plaintext
Epoch 1/10
235/235 [==============================] - 12s 48ms/step - loss: 0.3215 - accuracy: 0.9023 - val_loss: 0.0872 - val_accuracy: 0.9735
Epoch 2/10
235/235 [==============================] - 11s 47ms/step - loss: 0.0942 - accuracy: 0.9715 - val_loss: 0.0583 - val_accuracy: 0.9822
...
Epoch 10/10
235/235 [==============================] - 11s 47ms/step - loss: 0.0351 - accuracy: 0.9892 - val_loss: 0.0326 - val_accuracy: 0.9898

测试集准确率: 0.9895
真实标签: 7, 预测标签: 7
预测结果已保存为 mnist_prediction.png
```

## 3. 代码技术讲解

### 3.1 数据预处理（train.py/test.py/app.py）

- 图像归一化：将像素值从`[0,255]`转换为`[0,1]`（关键优化点，加速模型收敛）
- 维度调整：将`(28,28)`灰度图转换为`(28,28,1)`的 4D 张量（满足 CNN 输入格式）
- 标签处理：使用`to_categorical`进行 One-hot 编码，适配多分类损失函数

### 3.2 模型构建（train.py）

- 网络结构（CNN）：

  ```python
  # 卷积层+池化层（特征提取）
  Conv2D(32, (3,3), activation='relu') + MaxPooling2D((2,2))
  Conv2D(64, (3,3), activation='relu') + MaxPooling2D((2,2))
  # 正则化与展平
  Dropout(0.25) + Flatten()
  # 全连接层（分类）
  Dense(128, activation='relu') + Dropout(0.5)
  Dense(10, activation='softmax')  # 10类数字输出
  ```

- 编译配置：

  - 优化器：`adam`（自适应学习率，收敛更稳定）
  - 损失函数：`categorical_crossentropy`（多分类任务标准损失）
  - 评估指标：`accuracy`（分类准确率）

### 3.3 测试与预测（test.py）

- 模型加载：使用`load_model`加载训练好的模型
- 单样本预测：通过`model.predict`获取概率分布，`argmax`提取预测类别
- 可视化：使用`matplotlib`保存预测样本图像

### 3.4 Web 应用（app.py）

- 框架：Flask 构建 Web 服务，提供 HTTP 接口
- 图像处理：
  - 测试集图像：直接从 MNIST 测试集获取并转换为 base64 编码
  - 手绘图像：解码 base64 -> 转为灰度图 -> 调整为 28x28 -> 颜色反转（适配 MNIST 数据分布）
- 接口设计：
  - `/`：返回前端页面
  - `/accuracy`：返回模型准确率
  - `/predict`：处理预测请求（支持两种模式）

## 4. 代码流程思路讲解

1. **数据准备阶段**：
   - 从 Keras 内置接口加载 MNIST 数据集（训练集 60000 张，测试集 10000 张）
   - 统一数据格式与范围，确保训练 / 测试 / 预测阶段处理方式一致
2. **模型训练阶段**：
   - 构建 CNN 模型（特征提取 + 分类）
   - 划分验证集（20% 训练数据）监控过拟合
   - 训练完成后保存模型（`mnist_cnn_normalized.keras`）
3. **模型测试阶段**：
   - 加载保存的模型，在测试集上评估整体性能
   - 支持指定单一样本进行预测，输出详细结果并可视化
4. **Web 交互阶段**：
   - 封装模型为 Web 服务，提供直观的交互界面
   - 支持两种预测模式，覆盖测试集验证与自定义输入场景

## 5. 项目和数据集来源

### 5.1 数据集来源

- 使用 Keras 内置的 MNIST 手写数字数据集，包含 0-9 共 10 类手写数字图像
- 每张图像为 28x28 像素的灰度图，来自美国国家标准与技术研究院（NIST）的手写数字数据集子集

### 5.2 项目说明

- 本项目为深度学习入门实践项目，旨在演示卷积神经网络在图像识别任务中的应用
- 代码开源可复用，可作为基础框架扩展至其他图像识别任务（如自定义数字 / 字符识别）

## 运行说明

1. 安装依赖：

   ```bash
   pip install keras tensorflow flask matplotlib pillow numpy
   ```

   

2. 训练模型：

   ```bash
   python train.py
   ```

   

3. 测试单样本：

   ```bash
   python test.py  # 按提示输入测试索引
   ```

   

4. 启动 Web 应用：

   ```bash
   python app.py  # 访问http://localhost:5000使用Web界面
   ```